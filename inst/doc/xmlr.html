<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>xmlr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">xmlr</h1>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(xmlr)</code></pre></div>
<p>Xmlr is a document object model of XML written in base-R. It is similar in functionality to the XML package but does not have any dependencies or require compilation. Xmlr allows you to read, write and manipulate XML.</p>
<div id="why-xmlr" class="section level1">
<h1>Why xmlr?</h1>
<p>I had problems on one of my machines to install the XML package (some gcc issue) so needed an alternative. As I have been thinking about doing something more comprehensive with Reference Classes I decided to create a pure base-R DOM model with some simple ways to do input and output to strings and files. As it turned out to be useful to me, I thought it might be for others as well, so I decided to open source and publish it.</p>
</div>
<div id="creating-the-xml-tree" class="section level1">
<h1>Creating the XML tree</h1>
<p>There are 2 ways to create an XML tree, by parsing XML text or by creating it programmatically.</p>
<div id="parsing" class="section level2">
<h2>Parsing</h2>
<p>Xmlr supports two ways of parsing text: either from a character string or from a xml file. To parse a string you do something like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">doc &lt;-<span class="st"> </span><span class="kw">parse.xmlstring</span>(<span class="st">&quot;</span>
<span class="st">&lt;table xmlns='http://www.w3.org/TR/html4/'&gt;</span>
<span class="st">    &lt;tr&gt;</span>
<span class="st">        &lt;td class='fruit'&gt;Apples&lt;/td&gt;</span>
<span class="st">        &lt;td class='fruit'&gt;Bananas&lt;/td&gt;</span>
<span class="st">    &lt;/tr&gt;</span>
<span class="st">&lt;/table&gt;&quot;</span>)</code></pre></div>
<p>…and similarly to parse a XML file you do:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">doc &lt;-<span class="st"> </span><span class="kw">parse.xmlfile</span>(<span class="st">&quot;pom.xml&quot;</span>)</code></pre></div>
</div>
<div id="programmatic-creation" class="section level2">
<h2>Programmatic creation</h2>
<p>To create the following xml</p>
<pre><code>&lt;table xmlns='http://www.w3.org/TR/html4/'&gt;
    &lt;tr&gt;
        &lt;td class='fruit'&gt;Apples&lt;/td&gt;
        &lt;td class='fruit'&gt;Bananas&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
</code></pre>
<p>…you could do something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">doc &lt;-<span class="st"> </span>Document<span class="op">$</span><span class="kw">new</span>()
root &lt;-<span class="st"> </span>Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;table&quot;</span>)
root<span class="op">$</span><span class="kw">setAttribute</span>(<span class="st">&quot;xmlns&quot;</span>, <span class="st">&quot;http://www.w3.org/TR/html4/&quot;</span>)
doc<span class="op">$</span><span class="kw">setRootElement</span>(root)

root<span class="op">$</span><span class="kw">addContent</span>(
Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;tr&quot;</span>)
  <span class="op">$</span><span class="kw">addContent</span>(
    Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;td&quot;</span>)<span class="op">$</span><span class="kw">setAttribute</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;fruit&quot;</span>)<span class="op">$</span><span class="kw">setText</span>(<span class="st">&quot;Apples&quot;</span>)
  )
  <span class="op">$</span><span class="kw">addContent</span>(
    Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;td&quot;</span>)<span class="op">$</span><span class="kw">setAttribute</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;fruit&quot;</span>)<span class="op">$</span><span class="kw">setText</span>(<span class="st">&quot;Bananas&quot;</span>)
  )
)
<span class="co"># print it out just to show the content</span>
<span class="kw">print</span>(doc)
<span class="co">#&gt; &lt;table xmlns='http://www.w3.org/TR/html4/'&gt;&lt;tr&gt;&lt;td class='fruit'&gt;Apples&lt;/td&gt;&lt;td class='fruit'&gt;Bananas&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span></code></pre></div>
</div>
<div id="navigating-the-tree" class="section level2">
<h2>Navigating the tree</h2>
<p>As XML is a hierarchical model it is very well suited for an Object based implementation. The top-level class is the Document class. It contains a reference to the root element that you get through the <code>getRootElement()</code> method.</p>
<p>Elements contain attributes and child content (more elements or a Text node). To get the text of the second td element (tag) you would something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">doc<span class="op">$</span><span class="kw">getRootElement</span>()<span class="op">$</span><span class="kw">getChild</span>(<span class="st">&quot;tr&quot;</span>)<span class="op">$</span><span class="kw">getChildren</span>()[[<span class="dv">2</span>]]<span class="op">$</span><span class="kw">getText</span>()
<span class="co">#&gt; [1] &quot;Bananas&quot;</span></code></pre></div>
<p>This is useful when you have a more complex structure, and you want to create a data.frame of a part of the xml. e.g.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">groceriesDf &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="cf">for</span> ( child <span class="cf">in</span> doc<span class="op">$</span><span class="kw">getRootElement</span>()<span class="op">$</span><span class="kw">getChild</span>(<span class="st">&quot;tr&quot;</span>)<span class="op">$</span><span class="kw">getChildren</span>() ) {
  row &lt;-<span class="st"> </span><span class="kw">list</span>()
  row[[<span class="st">&quot;class&quot;</span>]] &lt;-<span class="st"> </span>child<span class="op">$</span><span class="kw">getAttribute</span>(<span class="st">&quot;class&quot;</span>)
  row[[<span class="st">&quot;item&quot;</span>]] &lt;-<span class="st"> </span>child<span class="op">$</span><span class="kw">getText</span>()
  <span class="cf">if</span> (<span class="kw">is.null</span>(groceriesDf)) {
    groceriesDf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(row, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
  } <span class="cf">else</span> {
    groceriesDf &lt;-<span class="st"> </span><span class="kw">rbind</span>(groceriesDf, row)
  }
}
groceriesDf
<span class="co">#&gt;   class    item</span>
<span class="co">#&gt; 1 fruit  Apples</span>
<span class="co">#&gt; 2 fruit Bananas</span></code></pre></div>
<p>You can also move upwards in the tree by using the <strong>getParent()</strong> function which exists for all Content (Element and Text nodes).</p>
</div>
<div id="outputting" class="section level2">
<h2>Outputting</h2>
<p>As you saw in the example above the default print will render the object model as an XML string. Print is available for each element and will print all the content in and below this element e.g.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># print the contents of the tr element </span>
root<span class="op">$</span><span class="kw">getChild</span>(<span class="st">&quot;tr&quot;</span>)
<span class="co">#&gt; &lt;tr&gt;&lt;td class='fruit'&gt;Apples&lt;/td&gt;&lt;td class='fruit'&gt;Bananas&lt;/td&gt;&lt;/tr&gt;</span></code></pre></div>
</div>
</div>
<div id="the-object-model" class="section level1">
<h1>The object model</h1>
<p>The xmlr object model is very simple, you basically only need to care about the Document and the Element classes. In general all Objects has a toString() function that returns the textual XML representation of the object. as.character and as.vector are also specified for each class allowing you to do stuff like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(<span class="st">&quot;The root element is&quot;</span>, root)
<span class="co">#&gt; [1] &quot;The root element is &lt;table xmlns='http://www.w3.org/TR/html4/'&gt;&lt;tr&gt;&lt;td class='fruit'&gt;Apples&lt;/td&gt;&lt;td class='fruit'&gt;Bananas&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;</span></code></pre></div>
<p>Which is the same as doing <code>paste(&quot;The root element is&quot;, root$toString())</code></p>
<div id="document" class="section level2">
<h2>Document</h2>
<p>As mentioned before the most useful thing to do with the Document object is to set or get the rootElement. In a future version you might also be interested in processing instructions etc. but those are not supported yet.</p>
</div>
<div id="element" class="section level2">
<h2>Element</h2>
<p>An Element has three “interests”, name, attributes and child nodes. text is handled in a special way (there is a Text class) since the form <code>&lt;foo&gt;Som text here&lt;/foo&gt;</code> is very common.</p>
<div id="name" class="section level3">
<h3>Name</h3>
<p>This set the name of the Element (the tag) e.g. to create the element <foo></foo> you can either do <code>e &lt;- Element$new(&quot;foo&quot;)</code> or use the <strong>setName(name)</strong> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">e &lt;-<span class="st"> </span>Element<span class="op">$</span><span class="kw">new</span>()
e<span class="op">$</span><span class="kw">setName</span>(<span class="st">&quot;foo&quot;</span>)</code></pre></div>
<p>To get the Element name you use the function <strong>getName()</strong></p>
</div>
<div id="attributes" class="section level3">
<h3>Attributes</h3>
<p>The following functions are available for attributes:</p>
<ul>
<li><strong>getAttribute(name)</strong> This gets the attribute value for the name argument supplied, e.g. <code>child$getAttribute(&quot;class&quot;)</code></li>
<li><strong>getAttributes()</strong> This gives you the list of attributes for this Element. You can navigate the list just like normal e.g. <code>child$getAttributes()[[&quot;class&quot;]]</code> or use in a loop or apply etc.</li>
<li><strong>setAttribute(name, value)</strong> Creates or updates an existing attribute for the name and value supplied. E.g. <code>root$setAttribute(&quot;xmlns&quot;, &quot;http://www.w3.org/TR/html4/&quot;)</code>.</li>
<li><strong>setAttributes(attributes)</strong> This sets all the attributes of the Element to the list given. Note that you MUST supply a named list for this to work. Any existing attribute will vanish.</li>
<li><strong>addAttributes(attributes)</strong> Similar to setAttributes but will not erase any existing attributes.</li>
<li><strong>hasAttributes()</strong> TRUE if any attributes are defined for the element.</li>
</ul>
</div>
<div id="content" class="section level3">
<h3>Content</h3>
<p>Content can be either other Element(s) or Text.</p>
<p>For the xml</p>
<pre><code>&lt;foo&gt;
  &lt;Bar note='Some text'&lt;/Bar&gt;
  &lt;Baz note='More stuff'&lt;/Baz&gt;
&lt;/foo&gt;</code></pre>
<p>…you can do something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">e &lt;-<span class="st"> </span>Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;foo&quot;</span>)<span class="op">$</span><span class="kw">addContent</span>(
  Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Bar&quot;</span>)<span class="op">$</span><span class="kw">setAttribute</span>(<span class="st">&quot;note&quot;</span>, <span class="st">&quot;Some text&quot;</span>)
)<span class="op">$</span><span class="kw">addContent</span>(
  Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Baz&quot;</span>)<span class="op">$</span><span class="kw">setAttribute</span>(<span class="st">&quot;note&quot;</span>, <span class="st">&quot;More stuff&quot;</span>)
)
e
<span class="co">#&gt; &lt;foo&gt;&lt;Bar note='Some text'&gt;&lt;/Bar&gt;&lt;Baz note='More stuff'&gt;&lt;/Baz&gt;&lt;/foo&gt;</span></code></pre></div>
<p>To retrieve content there are several ways:</p>
<ul>
<li><strong>getContent()</strong> This will get you the complete list of content regardless if they are Elements or Text nodes.</li>
<li><strong>getChildren()</strong> This will give you a list of Elements belonging to this element.</li>
<li><strong>removeContent(content)</strong> This will remove the content supplied from this Elements content list.</li>
<li><strong>removeContentAt(index)</strong> Same as above but for the position in the list matching the index supplied.</li>
<li><strong>contentIndex(content)</strong> Gives you the index of the content supplied or -1 if no content was found.</li>
<li><strong>getChild(name)</strong> Gives you the <em>first</em> occurrence of the Element that is a child of this element with the name matching the name supplied</li>
<li><strong>hasContent()</strong> TRUE if there is any content belonging to this element</li>
<li><strong>hasChildren()</strong> TRUE if there is any child elements for this element</li>
</ul>
</div>
<div id="text" class="section level3">
<h3>Text</h3>
<p>As mentioned above Text is treated a bit special. You typically use the <strong>setText(text)</strong> function to set text content e.g. to create <code>&lt;car&gt;Volvo&lt;/car&gt;</code> you would do:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">e &lt;-<span class="st"> </span>Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;car&quot;</span>)<span class="op">$</span><span class="kw">setText</span>(<span class="st">&quot;Volvo&quot;</span>)</code></pre></div>
<p>However, for more complex cases it is possible to mix text and elements using <strong>addContent()</strong>. E.g. for the xml <code>&lt;cars&gt;Volvo&lt;value sek='200000'&gt;&lt;/value&gt;&lt;/cars&gt;</code></p>
<p>You can create it by creating and adding a Text node explicitly rather than using the setText function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  xml &lt;-<span class="st"> &quot;&lt;car&gt;Volvo&lt;value sek='200000'&gt;&lt;/value&gt;&lt;/car&gt;&quot;</span>
  e &lt;-<span class="st"> </span>Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;car&quot;</span>)
  e<span class="op">$</span><span class="kw">addContent</span>(Text<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Volvo&quot;</span>))
  e<span class="op">$</span><span class="kw">addContent</span>(Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;value&quot;</span>)<span class="op">$</span><span class="kw">setAttribute</span>(<span class="st">&quot;sek&quot;</span>, <span class="st">&quot;200000&quot;</span>))
  <span class="kw">stopifnot</span>(e<span class="op">$</span><span class="kw">toString</span>() <span class="op">==</span><span class="st"> </span>xml)</code></pre></div>
<p>To check if there is any text defined for this element you can use the function <strong>hasText()</strong></p>
</div>
</div>
</div>
<div id="namespaces" class="section level1">
<h1>Namespaces</h1>
<p>Namespaces is handled in a very simplistic way in xmlr. You declare the namespace as an attribute, and you maintain the correct prefix “manually” by prefixing the element name e.g:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">parent &lt;-<span class="st"> </span>Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;parent&quot;</span>)
parent &lt;-<span class="st"> </span>Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;parent&quot;</span>)<span class="op">$</span><span class="kw">setAttribute</span>(<span class="st">&quot;xmlns:env&quot;</span>, <span class="st">&quot;http://some.namespace.com&quot;</span>)
parent<span class="op">$</span><span class="kw">addContent</span>(Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;env:child&quot;</span>))
parent
<span class="co">#&gt; &lt;parent xmlns:env='http://some.namespace.com'&gt;&lt;env:child&gt;&lt;/env:child&gt;&lt;/parent&gt;</span></code></pre></div>
</div>
<div id="other-useful-stuff" class="section level1">
<h1>Other useful stuff</h1>
<p>There is a simplistic way to produce a dataframe from a XML tree: <strong>xmlrToDataFrame(element)</strong> it can be used (similar to the xmlToDataFrame in the classic XML package) as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xml &lt;-<span class="st"> &quot;</span>
<span class="st">&lt;groceries&gt;</span>
<span class="st">  &lt;item type='fruit' number='4'&gt;Apples&lt;/item&gt;</span>
<span class="st">  &lt;item type='fruit' number='2'&gt;Bananas&lt;/item&gt;</span>
<span class="st">  &lt;item type='vegetables'number='6'&gt;Tomatoes&lt;/item&gt;</span>
<span class="st">&lt;/groceries&gt;</span>
<span class="st">&quot;</span>
doc &lt;-<span class="st"> </span><span class="kw">parse.xmlstring</span>(xml)
xmldf &lt;-<span class="st"> </span><span class="kw">xmlrToDataFrame</span>(doc<span class="op">$</span><span class="kw">getRootElement</span>())
xmldf
<span class="co">#&gt;         type number     item</span>
<span class="co">#&gt; 1      fruit      4   Apples</span>
<span class="co">#&gt; 2      fruit      2  Bananas</span>
<span class="co">#&gt; 3 vegetables      6 Tomatoes</span></code></pre></div>
<p>If you have a more complex xml structure you need to build your data frame “by hand” e.g. in a similar fashion to what was outlined in the “Navigating the tree” section.</p>
<div id="misc" class="section level2">
<h2>Misc</h2>
<p>There are some general purpose classes and functions that might be useful if you want to extend or customize xmlr:</p>
<ul>
<li><strong>isRc(x, clazz = “refClass”)</strong> Check if the object is a reference class, similar to isS4() when only the object is supplied but can be narrowed down to the specific RC class if the clazz argument is given. E.g. to check that the object is an Element you can do</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">isRc</span>(Element<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Hello&quot;</span>), <span class="st">&quot;Element&quot;</span>)
<span class="co">#&gt; [1] TRUE</span>
<span class="kw">isRc</span>(Text<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Hello&quot;</span>), <span class="st">&quot;Element&quot;</span>)
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<ul>
<li><strong>Stack</strong> This is a general purpose linked stack with the expected functions i.e.
<ul>
<li><strong>pop()</strong> Retrieve and remove the top item from the stack</li>
<li><strong>push(item)</strong> Add an item to the stack</li>
<li><strong>peek()</strong> Retrieve the top item from the stack without removing it</li>
<li><strong>size()</strong> Get the number of items on the stack</li>
<li><strong>isEmpty()</strong> Returns TRUE if the stack is empty or FALSE if it is still has items.</li>
</ul></li>
<li><strong>Parser</strong> A general purpose, SAX like, parser that you could create your own builder for. A builder needs to have the following functions (See <strong>DomBuilder</strong> for an example):
<ul>
<li><strong>startDocument()</strong></li>
<li><strong>endDocument()</strong></li>
<li><strong>startElement(name, attributes)</strong></li>
<li><strong>endElement(name)</strong></li>
<li><strong>text(text)</strong></li>
</ul></li>
</ul>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
